facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
library(tidyverse)
# Read burst stats file
bs = read.csv("bs_stats.csv")
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
data$muT <- (bs %>% filter(statSs=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
###################################################
# Plotting
###################################################
data %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(color=stages), size=.5)+
facet_wrap(zeros ~ freqs)
filter(data, zeros==1) %>% ggplot(aes(x=muT, y=cv))+
geom_boxplot(aes(color=stages))+
facet_wrap(~ freqs, ncol=5)
theme_set(
theme_gray() + theme(legend.position = "right")
)
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
View(bs)
View(bs)
library(tidyverse)
# Read burst stats file
bs = read.csv("bs_stats.csv")
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
data$muT <- (bs %>% filter(statSs=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
clear
rm()
rm()
rm(bs)
rm(data)
rm(plt)
rm(freqs.labs)
library(tidyverse)
# Read burst stats file
bs = read.csv("bs_stats.csv")
View(bs)
View(bs)
library(readr)
bs_stats <- read_csv("Documents/bs_stats.csv")
View(bs_stats)
bs= bs_stats
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
data$muT <- (bs %>% filter(statSs=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
###################################################
# Plotting
###################################################
data %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(color=stages), size=.5)+
facet_wrap(zeros ~ freqs)
filter(data, zeros==1) %>% ggplot(aes(x=muT, y=cv))+
geom_boxplot(aes(color=stages))+
facet_wrap(~ freqs, ncol=5)
theme_set(
theme_gray() + theme(legend.position = "right")
)
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)+
#facet_wrap(~ freqs, ncol=5,
#           labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)+
#facet_wrap(~ freqs, ncol=5,
#           labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)+
#facet_wrap(~ freqs, ncol=5,
#           labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)#+
facet_wrap(~ freqs, ncol=5,
#           labeller = labeller(freqs = freqs.labs))+
#
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)#+
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)#+
theme_set(
theme_gray() + theme(legend.position = "right")
)
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==1) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)#+
0
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
head(data)
library(tidyverse)
# Read burst stats file
bs = read.csv("Documents/bs_stats.csv")
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
data$muT <- (bs %>% filter(statSs=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
data
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
names(data)
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[5] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
data$muT <- (bs %>% filter(statSs=="muT"))$bs_stats
data$muT <- (bs %>% filter(stats=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
View(data)
View(data)
c
c
c
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=freqs, y=..count../sum(..count..)),
geom="step", bins=100)#+
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
###################################################
# Plotting
###################################################
data %>% ggplot(aes(x=roi, y=cv))+
geom_point(aes(color=freqs), size=.5)+
facet_wrap(zeros ~ freqs)
###################################################
# Plotting
###################################################
data %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(color=roi), size=.5)+
facet_wrap(zeros ~ freqs)
###################################################
# Plotting
###################################################
filter(data, zeros==0) %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(color=roi), size=.5)+
facet_wrap(~ freqs)
###################################################
# Plotting
###################################################
filter(data, zeros==0) %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(), size=.5)+
facet_wrap(~ freqs)
###################################################
# Plotting
###################################################
filter(data, zeros==0) %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(), size=.5)+
facet_wrap(~ freqs, ncol=5)
###################################################
# Plotting
###################################################
filter(data, zeros==1) %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(), size=.5)+
facet_wrap(~ freqs, ncol=5)
###################################################
# Plotting
###################################################
filter(data, zeros==0) %>% ggplot(aes(x=muT, y=cv))+
geom_point(aes(), size=.5)+
facet_wrap(~ freqs, ncol=5)
filter(data, zeros==0) %>% ggplot(aes(x=muT, y=cv))+
geom_boxplot(aes())+
facet_wrap(~ freqs, ncol=5)
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
geom_histogram(aes(color=freqs))
filter(data, zeros==0) %>% ggplot(aes(x=cv, color=freqs))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)#+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)#+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
filter(data, zeros==0) %>% ggplot(aes(x=cv))+
stat_bin(aes(color=roi, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
View(data)
View(data)
aggregate(data[, 5:8], list(data$roi), mean)
d %>%
group_by(roi) %>%
summarise_at(vars(-mu), funs(mean(., na.rm=TRUE)))
data %>%
group_by(roi) %>%
summarise_at(vars(-mu), funs(mean(., na.rm=TRUE)))
data %>%
group_by(roi) %>%
summarise_at(vars(mu), list(name = mean))
data %>%
group_by(roi) %>%
summarise_at(vars(muT), list(name = mean))
library(umap)
install.packages(umap)
install.packages("umap")
library(umap)
umap
d = filter(data, zeros==0)[ , 3:7]
d
head(d)
d = filter(data, zeros==0)[ , 4:8]
d
umap(d)
?umap
umap(d, config=umap.defaults)
data.umap = umap(data[,4:8])
setwd("~")
library(tidyverse)
library(umap)
# Read burst stats file
bs = read.csv("Documents/bs_stats.csv")
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[6] <- "mu"
###################################################
# Unwarap stats one in each column
###################################################
data <- bs %>% filter(stats=="mu")
data$stats <- NULL
names(data)[5] <- "mu"
data$std <- (bs %>% filter(stats=="std"))$bs_stats
data$muT <- (bs %>% filter(statSs=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
data$muT <- (bs %>% filter(stats=="muT"))$bs_stats
data$cv <- (bs %>% filter(stats=="cv"))$bs_stats
head(data)
umap
data.umap = umap(data[,4:8])
data.umap = umap(data[,4:8], method = "umap-learn")
Y
Y
data.umap = umap(data[,4:8], method = "umap-learn")
write_csv(data, "bs_stats.csv")
bs = read.csv("burstness.csv")
head(bs)
data = bs
theme_set(
theme_gray() + theme(legend.position = "right")
)
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
data%>% ggplot(aes(x=cv))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
data%>% ggplot(aes(x=burstness))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
library(tidyverse)
data%>% ggplot(aes(x=burstness))+
stat_bin(aes(color=stages, y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
data%>% ggplot(aes(x=burstness))+
stat_bin(aes(y=..count../sum(..count..)),
geom="step", bins=100)+
facet_wrap(~ freqs, ncol=5,
labeller = labeller(freqs = freqs.labs))+
ylab("#count")
data %>% ggplot(aes(x=roi, y=burstness))+
geom_boxplot(aes(color=stages))+
facet_wrap(~ freqs, ncol=5)
data %>% ggplot(aes(x=roi, y=burstness))+
geom_boxplot(aes(color=freqs))+
facet_wrap(~ freqs, ncol=5)
filter(data, freqs==3) %>% ggplot(aes(x=roi, y=burstness))+
geom_boxplot(aes())#+
filter(data, freqs==3) %>% ggplot(aes(x=roi, y=burstness))+
geom_point(aes())#+
library(tidyverse)
library(umap)
# Titles for frequencies
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
# Stages names
stages = c("Baseline", "Cue", "Early delay", "Late delay", "Match")
for(i in 0:4){
df = read.csv(
"Results/lucy/mutual_information/mi_df.csv"
)
df <- df %>% gather(key = metric, value = t_values, c("power", "degree", "coreness", "efficiency"))
df <- df %>% filter(times==i)
ggplot(data=df, aes(x=roi, y=t_values, fill = metric)) +
geom_bar(alpha = 0.7, stat='identity', position="stack") +
ylim(-10, 80) +
coord_flip() +
facet_wrap(~freqs, ncol=5,
labeller = labeller(freqs = freqs.labs)) +
ggtitle(stages[i+1]) +
theme(plot.title = element_text(hjust=0.5))
ggsave(
paste(c("figures/mi_hist_", i, ".png"), collapse = ""),
width = 12, height = 8)
}
setwd("~/storage1/projects/GrayData-Analysis")
library(tidyverse)
library(umap)
# Titles for frequencies
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
# Stages names
stages = c("Baseline", "Cue", "Early delay", "Late delay", "Match")
for(i in 0:4){
df = read.csv(
"Results/lucy/mutual_information/mi_df.csv"
)
df <- df %>% gather(key = metric, value = t_values, c("power", "degree", "coreness", "efficiency"))
df <- df %>% filter(times==i)
ggplot(data=df, aes(x=roi, y=t_values, fill = metric)) +
geom_bar(alpha = 0.7, stat='identity', position="stack") +
ylim(-10, 80) +
coord_flip() +
facet_wrap(~freqs, ncol=5,
labeller = labeller(freqs = freqs.labs)) +
ggtitle(stages[i+1]) +
theme(plot.title = element_text(hjust=0.5))
ggsave(
paste(c("figures/mi_hist_", i, ".png"), collapse = ""),
width = 12, height = 8)
}
ggplot(data=df, aes(x=roi, y=t_values, fill = metric)) +
geom_bar(alpha = 0.7, stat='identity', position="stack") +
ylim(-10, 80) +
coord_flip() +
facet_wrap(~freqs, ncol=5,
labeller = labeller(freqs = freqs.labs)) +
ggtitle(stages[i+1]) +
theme(plot.title = element_text(hjust=0.5))
library(tidyverse)
library(umap)
# Titles for frequencies
freqs.labs <- c("3 Hz", "11 Hz", "19 Hz", "27 Hz", "35 Hz",
"43 Hz", "51 Hz", "59 Hz", "67 Hz", "75 Hz")
names(freqs.labs) <- list(3, 11, 19, 27, 35, 43, 51, 59, 67, 75)
# Stages names
stages = c("Baseline", "Cue", "Early delay", "Late delay", "Match")
for(i in 0:4){
df = read.csv(
"Results/lucy/mutual_information/mi_df.csv"
)
df <- df %>% gather(key = metric, value = t_values, c("power", "degree", "coreness", "efficiency"))
df <- df %>% filter(times==i)
ggplot(data=df, aes(x=roi, y=t_values, fill = metric)) +
geom_bar(alpha = 0.7, stat='identity', position="stack") +
ylim(0, 80) +
coord_flip() +
facet_wrap(~freqs, ncol=5,
labeller = labeller(freqs = freqs.labs)) +
ggtitle(stages[i+1]) +
theme(plot.title = element_text(hjust=0.5))
ggsave(
paste(c("figures/mi_hist_", i, ".png"), collapse = ""),
width = 12, height = 8)
}
ggplot(data=df, aes(x=roi, y=t_values, fill = metric)) +
geom_bar(alpha = 0.7, stat='identity', position="stack") +
ylim(0, 80) +
coord_flip() +
facet_wrap(~freqs, ncol=5,
labeller = labeller(freqs = freqs.labs)) +
ggtitle(stages[i+1]) +
theme(plot.title = element_text(hjust=0.5))
